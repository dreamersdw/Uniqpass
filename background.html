<script type="text/javascript" charset="utf-8" src="md5.js"></script>
<script type="text/javascript" charset="utf-8" src="util.js"></script>
<script type="text/javascript">

var listener = function(request, sender, sendResponse) {
    switch (request.reason) {
        case "ask_salted_password": 
            sendResponse({pwd: md5(localStorage["master_password"] + select_domain(request.domain))});
            break;
        case "ask_shortcut":
            sendResponse({shortcut:localStorage["shortcut"] });
            break;
        default:
            sendResponse({}); 
    }
};

chrome.extension.onRequest.addListener(listener);
</script>
